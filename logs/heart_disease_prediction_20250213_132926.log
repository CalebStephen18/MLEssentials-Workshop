2025-02-13 13:29:26,135 - __main__ - INFO - Starting Heart Disease Prediction Pipeline
2025-02-13 13:29:26,135 - __main__ - INFO - Arguments: Namespace(data_path='data/heart.csv', experiment_name='Heart Disease Prediction', n_estimators=100, max_depth=None, log_level='INFO', model_output='models')
2025-02-13 13:29:26,135 - root - INFO - Created directory: models
2025-02-13 13:29:26,135 - root - INFO - Created directory: mlruns
2025-02-13 13:29:26,135 - __main__ - INFO - Starting data pipeline
2025-02-13 13:29:26,135 - src.data_prep - INFO - Loading data from data/heart.csv
2025-02-13 13:29:26,150 - src.data_prep - INFO - Loaded 918 rows and 12 columns
2025-02-13 13:29:26,200 - __main__ - INFO - Dataset Information:
2025-02-13 13:29:26,200 - __main__ - INFO - Total Samples: 918
2025-02-13 13:29:26,200 - __main__ - INFO - Features: ['Age', 'Sex', 'ChestPainType', 'RestingBP', 'Cholesterol', 'FastingBS', 'RestingECG', 'MaxHR', 'ExerciseAngina', 'Oldpeak', 'ST_Slope', 'HeartDisease']
2025-02-13 13:29:26,200 - __main__ - INFO - Missing Values: 0
2025-02-13 13:29:26,200 - __main__ - INFO - Target Distribution: {1: 508, 0: 410}
2025-02-13 13:29:26,202 - __main__ - INFO - Preprocessing data...
2025-02-13 13:29:26,202 - src.data_prep - INFO - Starting data preprocessing
2025-02-13 13:29:26,202 - src.data_prep - INFO - Encoding categorical column: Sex
2025-02-13 13:29:26,202 - src.data_prep - INFO - Encoding categorical column: ChestPainType
2025-02-13 13:29:26,202 - src.data_prep - INFO - Encoding categorical column: RestingECG
2025-02-13 13:29:26,202 - src.data_prep - INFO - Encoding categorical column: ExerciseAngina
2025-02-13 13:29:26,202 - src.data_prep - INFO - Encoding categorical column: ST_Slope
2025-02-13 13:29:26,202 - src.data_prep - INFO - Checking for missing values
2025-02-13 13:29:26,207 - src.data_prep - INFO - Creating new features
2025-02-13 13:29:26,208 - src.data_prep - INFO - Starting feature engineering
2025-02-13 13:29:26,208 - src.data_prep - INFO - Creating age groups
2025-02-13 13:29:26,225 - src.data_prep - INFO - Creating blood pressure categories
2025-02-13 13:29:26,227 - src.data_prep - INFO - Creating heart rate categories
2025-02-13 13:29:26,229 - src.data_prep - INFO - Creating interaction features
2025-02-13 13:29:26,230 - src.data_prep - INFO - Encoding new categorical features
2025-02-13 13:29:26,232 - src.data_prep - INFO - Feature engineering completed
2025-02-13 13:29:26,232 - src.data_prep - INFO - Preprocessing completed
2025-02-13 13:29:26,233 - __main__ - INFO - Preparing data for training...
2025-02-13 13:29:26,233 - src.data_prep - INFO - Preparing data for training
2025-02-13 13:29:26,236 - src.data_prep - INFO - Scaling numeric features
2025-02-13 13:29:26,240 - src.data_prep - INFO - Splitting data into train and test sets
2025-02-13 13:29:26,246 - src.data_prep - INFO - Training set size: 734, Test set size: 184
2025-02-13 13:29:26,248 - __main__ - INFO - Initializing model...
2025-02-13 13:29:26,248 - src.model - INFO - Initializing model with 100 trees
2025-02-13 13:29:26,248 - __main__ - INFO - Training model...
2025-02-13 13:29:26,248 - src.model - INFO - Setting up MLflow experiment: Heart Disease Prediction
2025-02-13 13:29:27,505 - src.model - INFO - Starting model training
2025-02-13 13:29:27,638 - src.model - INFO - Model training completed
2025-02-13 13:29:27,638 - src.model - INFO - Logging model parameters
2025-02-13 13:29:27,645 - src.model - INFO - Logging model to MLflow
2025-02-13 13:29:34,747 - src.model - INFO - Calculating and logging feature importance
2025-02-13 13:29:34,754 - src.model - INFO - Top 10 important features:
2025-02-13 13:29:34,754 - src.model - INFO - ST_Slope: 0.2384
2025-02-13 13:29:34,754 - src.model - INFO - ChestPainType: 0.1082
2025-02-13 13:29:34,754 - src.model - INFO - Oldpeak: 0.0952
2025-02-13 13:29:34,758 - src.model - INFO - MaxHR: 0.0808
2025-02-13 13:29:34,758 - src.model - INFO - Cholesterol: 0.0806
2025-02-13 13:29:34,758 - src.model - INFO - ExerciseAngina: 0.0735
2025-02-13 13:29:34,758 - src.model - INFO - Age_HR_Interaction: 0.0627
2025-02-13 13:29:34,758 - src.model - INFO - Age_BP_Interaction: 0.0569
2025-02-13 13:29:34,760 - src.model - INFO - Age: 0.0490
2025-02-13 13:29:34,760 - src.model - INFO - RestingBP: 0.0424
2025-02-13 13:29:34,763 - __main__ - INFO - Evaluating model...
2025-02-13 13:29:34,764 - src.model - INFO - Starting model evaluation
2025-02-13 13:29:34,786 - src.model - INFO - Making predictions on test set
2025-02-13 13:29:34,792 - src.model - INFO - Calculating evaluation metrics
2025-02-13 13:29:34,804 - src.model - INFO - Model accuracy: 0.8859
2025-02-13 13:29:34,810 - src.model - INFO - Classification Report:
2025-02-13 13:29:34,815 - src.model - INFO - 
              precision    recall  f1-score   support

           0       0.88      0.87      0.87        82
           1       0.89      0.90      0.90       102

    accuracy                           0.89       184
   macro avg       0.88      0.88      0.88       184
weighted avg       0.89      0.89      0.89       184

2025-02-13 13:29:34,818 - src.model - INFO - Saving model to models\heart_disease_model_20250213_132934
2025-02-13 13:29:37,946 - src.model - INFO - Model saved successfully
2025-02-13 13:29:37,946 - __main__ - INFO - Model saved to models\heart_disease_model_20250213_132934
2025-02-13 13:29:37,946 - __main__ - INFO - 
==================================================
2025-02-13 13:29:37,946 - __main__ - INFO - Training completed successfully!
2025-02-13 13:29:37,946 - __main__ - INFO - Model accuracy: 0.8859
2025-02-13 13:29:37,946 - __main__ - INFO - 
Classification Report:
2025-02-13 13:29:37,950 - __main__ - INFO -               precision    recall  f1-score   support

           0       0.88      0.87      0.87        82
           1       0.89      0.90      0.90       102

    accuracy                           0.89       184
   macro avg       0.88      0.88      0.88       184
weighted avg       0.89      0.89      0.89       184

2025-02-13 13:29:37,950 - __main__ - INFO - 
To view the experiment in MLflow UI:
2025-02-13 13:29:37,950 - __main__ - INFO - 1. Run: mlflow ui
2025-02-13 13:29:37,952 - __main__ - INFO - 2. Open: http://localhost:5000
2025-02-13 13:29:37,952 - __main__ - INFO - ==================================================
2025-02-13 13:29:37,952 - __main__ - INFO - Pipeline execution completed
